query ConversationList($cursor: OpaqueCursorPage!) {
    conversations(page: $cursor) {
        conversations {
            ...ConversationFragment
        }
        nextCursor
    }
}

subscription ConversationsEvents {
    conversations {
        ... on ConversationCreatedEvent {
            conversation {
                ...ConversationFragment
            }
        }
        ... on ConversationUpdatedEvent {
            conversation {
                ...ConversationFragment
            }
        }
        ... on ConversationDeletedEvent {
            conversationID
        }
    }
}

fragment ConversationFragment on Conversation {
    id
    title
    description
    lastMessagePreview
    unreadMessageCount
    providers {
        ...ProviderInConversationFragment
    }
}

fragment ProviderInConversationFragment on ProviderInConversation {
    id
    provider {
        ...ProviderFragment
    }
    isTyping
    seenUntil
}

fragment ProviderFragment on Provider {
    id
    avatarUrl {
        ...EphemeralUrlFragment
    }
}

fragment EphemeralUrlFragment on EphemeralUrl {
    expiresAt
    url
}
